# 交易执行环节

智能体负责实时输出模拟账户仓位，但它并不直接与市场交互，这是为了保持无状态，简化智能体的逻辑。

我们使用账户组合器来组合模拟账户的信息，得到实盘交易所需的计划账户信息。然后，使用交易执行器使得真实交易账户的仓位与计划账户的仓位保持一致。

## 核心组件

### [@yuants/app-account-composer](apps/account-composer)

账户组合器。它可以从若干账户计算派生出一个新的账户信息。用途广泛，可以将多个智能体的账户合并为一个账户。

### [@yuants/app-trade-copier](apps/trade-copier)

跟单器。它**向市场发送订单**确保真实账户跟随计划账户，其目标是保持两者的仓位一致。支持配置多种微策略，例如市价追入、限制单笔成交量、滚动最优挂单等。当然，你也可以使用一个真实账户跟随另一个真实账户。

### [@yuants/app-transfer-controller](apps/transfer-controller)

转账控制器是一个在账户之间转账的服务。它监视转账请求并确保转账完成。

### [@yuants/app-risk-manager](apps/risk-manager)

这将部署一个终端作为风险管理器。它根据配置的风险信息做出转账决策。

## 执行流程

1. **仓位计算**: 智能体输出模拟账户仓位
2. **账户组合**: 账户组合器合并多个账户信息
3. **计划生成**: 生成实盘交易计划账户
4. **跟单执行**: 跟单器确保真实账户跟随计划账户
5. **风险控制**: 风险管理器监控和控制风险

## 跟单策略

### 市价追入

- 使用市价单快速建立仓位
- 适用于流动性较好的市场
- 执行速度快，但可能有滑点

### 限制单笔成交量

- 限制每笔交易的最大成交量
- 避免对市场造成过大冲击
- 适用于大额交易

### 滚动最优挂单

- 在最优价位挂单
- 随着市场变化调整挂单价格
- 追求更好的成交价格

## 资金管理

### 转账控制

- 在账户之间安全转账
- 监控转账请求状态
- 确保转账完成

### 风险控制

- 根据风险配置做出决策
- 监控账户风险水平
- 自动平衡资金分配

### 物流网络

- 在不同的账户之间按照策略自动平衡资金
- 优化资金使用效率
- 降低整体风险

## 设计优势

- **无状态智能体**: 简化策略逻辑，提高可靠性
- **灵活组合**: 支持多种账户组合方式
- **智能跟单**: 多种跟单策略适应不同市场
- **全面风控**: 多层次风险控制机制

<p align="right">(<a href="../../README.zh-Hans.md">返回 README</a>) | <a href="architecture-overview.md">架构概述</a></p>
