## API Report File for "@yuants/kernel"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { IAccountInfo } from '@yuants/protocol';
import { IOrder } from '@yuants/protocol';
import { IPeriod } from '@yuants/protocol';
import { IPosition } from '@yuants/protocol';
import { IProduct } from '@yuants/protocol';
import { Observable } from 'rxjs';
import { PositionVariant } from '@yuants/protocol';
import { Terminal } from '@yuants/protocol';

// @public (undocumented)
export class AccountInfoUnit extends BasicUnit {
    constructor(kernel: Kernel, productDataUnit: ProductDataUnit, quoteDataUnit: QuoteDataUnit, historyOrderUnit: HistoryOrderUnit);
    // (undocumented)
    getPosition: (account_id: string, position_id: string, product_id: string, variant: PositionVariant) => IPosition;
    // (undocumented)
    historyOrderUnit: HistoryOrderUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    mapAccountIdToAccountInfo: Map<string, IAccountInfo>;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onInit(): void | Promise<void>;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
    // (undocumented)
    updateAccountInfo(accountId: string): void;
    // (undocumented)
    useAccount(account_id: string, currency: string, leverage?: number, initial_balance?: number): IAccountInfo;
}

// @public (undocumented)
export class AccountPerformanceHubUnit extends BasicUnit {
    constructor(kernel: Kernel, accountInfoUnit: AccountInfoUnit);
    // (undocumented)
    accountInfoUnit: AccountInfoUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    mapAccountIdToPerformance: Map<string, IAccountPerformance>;
    // (undocumented)
    onEvent(): void | Promise<void>;
}

// @public (undocumented)
export class AccountPerformanceMetricsUnit extends BasicUnit {
    constructor(kernel: Kernel, accountPerformanceUnit: AccountPerformanceHubUnit);
    // (undocumented)
    accountPerformanceUnit: AccountPerformanceHubUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
}

// @public
export class AccountPerformanceUnit extends BasicUnit {
    constructor(kernel: Kernel, accountUnit: AccountSimulatorUnit);
    // (undocumented)
    accountUnit: AccountSimulatorUnit;
    // (undocumented)
    kernel: Kernel;
    static makeInitAccountPerformance: (account_id: string) => IAccountPerformance;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    performance: IAccountPerformance;
    static reduceAccountPerformance: (acc: IAccountPerformance, cur: IAccountInfo) => IAccountPerformance;
}

// @public
export const AccountReplayScene: (terminal: Terminal, account_id: string, currency: string, leverage: number, start_timestamp: number, end_timestamp: number, period_in_sec: number, datasource_id?: string) => {
    kernel: Kernel;
    accountInfoUnit: AccountInfoUnit;
    accountPerformanceUnit: AccountPerformanceHubUnit;
};

// @public @deprecated
export class AccountSimulatorUnit extends BasicUnit {
    constructor(kernel: Kernel, productDataUnit: ProductDataUnit, quoteDataUnit: QuoteDataUnit, historyOrderUnit: HistoryOrderUnit, accountInfo: IAccountInfo);
    // (undocumented)
    accountInfo: IAccountInfo;
    // (undocumented)
    getPosition(position_id: string, product_id: string, variant: PositionVariant): IPosition;
    // (undocumented)
    historyOrderUnit: HistoryOrderUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void;
    // (undocumented)
    onInit(): void | Promise<void>;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
}

// @public
export class BasicUnit implements IKernelUnit {
    constructor(kernel: Kernel);
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onIdle(): void | Promise<void>;
    // (undocumented)
    onInit(): void | Promise<void>;
}

// @public
export const createEmptyAccountInfo: (account_id: string, currency: string, leverage?: number, initial_balance?: number) => IAccountInfo;

// @public (undocumented)
export class DataLoadingTaskUnit extends BasicUnit {
    constructor(kernel: Kernel);
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    periodTasks: {
        datasource_id: string;
        product_id: string;
        period_in_sec: number;
        start_time_in_us: number;
        end_time_in_us: number;
    }[];
    // (undocumented)
    productTasks: {
        datasource_id: string;
        product_id: string;
    }[];
}

// @public
export const diffPosition: (source: IPosition[], target: IPosition[]) => IPositionDiff[];

// @public
export const getClosePriceByDesiredProfit: (product: IProduct, openPrice: number, volume: number, desiredProfit: number, variant: PositionVariant, currency: string, quotes: (product_id: string) => {
    ask: number;
    bid: number;
} | undefined) => number;

// @public
export const getMargin: (product: IProduct, openPrice: number, volume: number, variant: PositionVariant, currency: string, quote: (product_id: string) => {
    ask: number;
    bid: number;
} | undefined) => number;

// @public
export const getProfit: (product: IProduct, openPrice: number, closePrice: number, volume: number, variant: PositionVariant, currency: string, quotes: (product_id: string) => {
    ask: number;
    bid: number;
} | undefined) => number;

// @public
export class HistoryOrderUnit extends BasicUnit {
    constructor(kernel: Kernel, quoteDataUnit: QuoteDataUnit, productDataUnit: ProductDataUnit);
    historyOrders: IOrder[];
    // (undocumented)
    kernel: Kernel;
    orderUpdated$: Observable<IOrder>;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
    updateOrder(order: IOrder): void;
}

// @public
export class HistoryPeriodLoadingUnit extends BasicUnit {
    constructor(kernel: Kernel, terminal: Terminal, productDataUnit: ProductDataUnit, periodDataUnit: PeriodDataUnit);
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onInit(): Promise<void>;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
    // (undocumented)
    periodTasks: {
        datasource_id: string;
        product_id: string;
        period_in_sec: number;
        start_time_in_us: number;
        end_time_in_us: number;
    }[];
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    terminal: Terminal;
}

// @public
export interface IAccountPerformance {
    // (undocumented)
    account_id: string;
    avg_profit_per_day: number;
    capital_occupancy_rate: number;
    // (undocumented)
    currency: string;
    daily_return_ratio: number;
    // (undocumented)
    _daily_return_ratio_list: number[];
    daily_sharpe_ratio: number;
    daily_sortino_ratio: number;
    drawdown: number;
    equity: number;
    equity_base: number;
    expect_everyday_downside_profit: number;
    expect_everyday_profit: number;
    expect_everyweek_downside_profit: number;
    expect_everyweek_profit: number;
    expect_squared_everyday_downside_profit: number;
    expect_squared_everyday_profit: number;
    expect_squared_everyweek_downside_profit: number;
    expect_squared_everyweek_profit: number;
    first_order_timestamp: number;
    // (undocumented)
    first_timestamp: number;
    // (undocumented)
    _history_position_performance: IAccountPositionPerformance[];
    // (undocumented)
    _history_weekly_equity: Array<{
        high: number;
        low: number;
    }>;
    integral_maintenance_margin: number;
    maintenance_margin: number;
    max_drawdown: number;
    max_equity: number;
    max_equity_base: number;
    max_maintenance_margin: number;
    max_used_margin: number;
    min_profit_interquartile_range: number;
    min_profit_lower_fence: number;
    min_profit_lower_fence_out_count: number;
    min_profit_p25: number;
    min_profit_p75: number;
    opening_equity: number;
    payback_period_in_days: number;
    // Warning: (ae-forgotten-export) The symbol "IAccountPositionPerformance" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    _position_performance_list: Record<string, IAccountPositionPerformance>;
    profit_drawdown_ratio: number;
    this_week_first_equity: number;
    this_week_profit: number;
    // (undocumented)
    timestamp: number;
    today_first_equity: number;
    today_profit: number;
    total_days: number;
    total_downside_days: number;
    total_downside_weeks: number;
    total_positions: number;
    total_weeks: number;
    volatility_everyday_downside_profit: number;
    volatility_everyday_profit: number;
    volatility_everyweek_downside_profit: number;
    volatility_everyweek_profit: number;
    // (undocumented)
    _weekly_equity: number[];
    // (undocumented)
    _weekly_first_timestamp: number[];
    weekly_return_ratio: number;
    // (undocumented)
    _weekly_return_ratio_list: number[];
    weekly_sharpe_ratio: number;
    weekly_sortino_ratio: number;
    yearly_return_ratio: number;
}

// @public
export interface IKernelUnit {
    kernel: Kernel;
    onDispose(): void | Promise<void>;
    onEvent(): void | Promise<void>;
    onIdle(): void | Promise<void>;
    onInit(): void | Promise<void>;
}

// @public (undocumented)
export interface IPortfolioStatistics {
    // (undocumented)
    coefficients: Record<string, number>;
    // (undocumented)
    period_end_target_account_info: IAccountInfo;
    // (undocumented)
    period_source_account_statistics: Record<string, {
        start_account_info: IAccountInfo;
        end_account_info: IAccountInfo;
        performance: IAccountPerformance;
    }>;
    // (undocumented)
    period_start_target_account_info: IAccountInfo;
    // (undocumented)
    start_timestamp: number;
    // (undocumented)
    target_account_performance: IAccountPerformance;
}

// @public (undocumented)
export interface IPositionDiff {
    error_volume: number;
    product_id: string;
    variant: PositionVariant;
    volume_in_source: number;
    volume_in_target: number;
}

// @public
export class Kernel {
    constructor(id?: string);
    addUnit(unit: IKernelUnit): void;
    alloc(timestamp: number): number;
    chronologicErrors: number;
    currentEventId: number;
    currentTimestamp: number;
    // (undocumented)
    id: string;
    log: ((...params: any[]) => void) | undefined;
    start(): Promise<void>;
    status: 'created' | 'initializing' | 'running' | 'terminating' | 'terminated' | 'idle';
    terminate(): void;
    units: IKernelUnit[];
}

// @public (undocumented)
export class KernelFramesMetricsUnit extends BasicUnit {
    constructor(kernel: Kernel, account_id: string);
    // (undocumented)
    account_id: string;
    // (undocumented)
    frameCnt: number;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
}

// @public
export const mergePositions: (positions: IPosition[]) => IPosition[];

// @public
export class OrderLoadingUnit extends BasicUnit {
    constructor(kernel: Kernel, terminal: Terminal, historyOrderUnit: HistoryOrderUnit);
    // (undocumented)
    historyOrderUnit: HistoryOrderUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onInit(): Promise<void>;
    relatedProductIds: Set<string>;
    // (undocumented)
    tasks: {
        account_id: string;
        start_time: number;
        end_time: number;
    }[];
    // (undocumented)
    terminal: Terminal;
}

// @public
export class OrderMatchingUnit extends BasicUnit {
    constructor(kernel: Kernel, productDataUnit: ProductDataUnit, periodDataUnit: PeriodDataUnit, historyOrderUnit: HistoryOrderUnit, quoteDataUnit: QuoteDataUnit);
    // (undocumented)
    cancelOrder(...orderIds: string[]): void;
    // (undocumented)
    getOrderById(id: string): IOrder | undefined;
    // (undocumented)
    historyOrderUnit: HistoryOrderUnit;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    listOrders(): IOrder[];
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onInit(): void | Promise<void>;
    orderCancelled$: Observable<string[]>;
    orderSubmitted$: Observable<IOrder[]>;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
    // (undocumented)
    submitOrder(...orders: IOrder[]): void;
}

// @public
export const OrderMergeReplayScene: (kernel: Kernel, init_account_info: IAccountInfo, periods: IPeriod[], orders: IOrder[], products: IProduct[]) => {
    kernel: Kernel;
    accountInfoUnit: AccountSimulatorUnit;
    accountPerformanceUnit: AccountPerformanceUnit;
    productDataUnit: ProductDataUnit;
    quoteDataUnit: QuoteDataUnit;
    periodDataUnit: PeriodDataUnit;
};

// @public
export class PeriodDataCheckingUnit extends BasicUnit {
    constructor(kernel: Kernel, terminal: Terminal, account_id: string, periodDataUnit: PeriodDataUnit, interval: number);
    // (undocumented)
    account_id: string;
    // (undocumented)
    errorTotal: number;
    // (undocumented)
    interval: number;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onInit(): void;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
    // (undocumented)
    periodTasks: {
        datasource_id: string;
        product_id: string;
        period_in_sec: number;
        start_time_in_us: number;
    }[];
    // (undocumented)
    terminal: Terminal;
}

// @public
export class PeriodDataUnit extends BasicUnit {
    constructor(kernel: Kernel, quoteDataUnit: QuoteDataUnit);
    // @deprecated (undocumented)
    currentPeriod: IPeriod | null;
    // (undocumented)
    data: Record<string, IPeriod[]>;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void;
    periodUpdated$: Observable<IPeriod>;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
    // (undocumented)
    updatePeriod(period: IPeriod): void;
}

// @public (undocumented)
export class PeriodMetricsUnit extends BasicUnit {
    constructor(kernel: Kernel, account_id: string, periodDataUnit: PeriodDataUnit);
    // (undocumented)
    account_id: string;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
}

// @public
export class PortfolioSimulatorUnit extends BasicUnit {
    constructor(kernel: Kernel, coefficient_fn_str: string, periodDataUnit: PeriodDataUnit, productDataUnit: ProductDataUnit, mapAccountInfoToUnits: Record<string, {
        accountInfoUnit: AccountSimulatorUnit;
        accountPerformanceUnit: AccountPerformanceUnit;
        originAccountInfoUnit: AccountSimulatorUnit;
        originAccountPerformanceUnit: AccountPerformanceUnit;
        historyOrderUnit: HistoryOrderUnit;
    }>, targetAccountInfoUnit: AccountSimulatorUnit, targetAccountPerformanceUnit: AccountPerformanceUnit, targetOrderMatchingUnit: OrderMatchingUnit);
    // (undocumented)
    coefficient_fn_str: string;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    mapAccountInfoToUnits: Record<string, {
        accountInfoUnit: AccountSimulatorUnit;
        accountPerformanceUnit: AccountPerformanceUnit;
        originAccountInfoUnit: AccountSimulatorUnit;
        originAccountPerformanceUnit: AccountPerformanceUnit;
        historyOrderUnit: HistoryOrderUnit;
    }>;
    // (undocumented)
    onEvent(): void;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    statistics: IPortfolioStatistics[];
    // (undocumented)
    targetAccountInfoUnit: AccountSimulatorUnit;
    // (undocumented)
    targetAccountPerformanceUnit: AccountPerformanceUnit;
    // (undocumented)
    targetOrderMatchingUnit: OrderMatchingUnit;
}

// @public
export class ProductDataUnit extends BasicUnit {
    // (undocumented)
    mapProductIdToProduct: Record<string, IProduct>;
}

// @public
export class ProductLoadingUnit extends BasicUnit {
    constructor(kernel: Kernel, terminal: Terminal, productDataUnit: ProductDataUnit, options?: {
        use_general_product?: boolean | undefined;
        allow_fallback_specific_product?: boolean | undefined;
    } | undefined);
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onInit(): Promise<void>;
    // (undocumented)
    options?: {
        use_general_product?: boolean | undefined;
        allow_fallback_specific_product?: boolean | undefined;
    } | undefined;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    productTasks: {
        datasource_id: string;
        product_id: string;
    }[];
    // (undocumented)
    terminal: Terminal;
}

// @public
export class QuoteDataUnit extends BasicUnit {
    // (undocumented)
    mapProductIdToQuote: Record<string, {
        ask: number;
        bid: number;
    }>;
}

// @public (undocumented)
export class QuoteMetricsUnit extends BasicUnit {
    constructor(kernel: Kernel, account_id: string, quoteDataUnit: QuoteDataUnit);
    // (undocumented)
    account_id: string;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
}

// @public
export class RealtimePeriodLoadingUnit extends BasicUnit {
    constructor(kernel: Kernel, terminal: Terminal, productDataUnit: ProductDataUnit, periodDataUnit: PeriodDataUnit);
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void | Promise<void>;
    // (undocumented)
    onIdle(): Promise<void>;
    // (undocumented)
    onInit(): Promise<void>;
    // (undocumented)
    periodDataUnit: PeriodDataUnit;
    // (undocumented)
    periodTasks: {
        datasource_id: string;
        product_id: string;
        period_in_sec: number;
    }[];
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    terminal: Terminal;
}

// @public
export class Series extends Array<number> {
    findParentWard(predicate: (series: Series) => any): Series | undefined;
    name: string | undefined;
    parent: Series | undefined;
    resolveRoot(): Series;
    resolveValue(tagName: string): any;
    series_id: string;
    tags: Record<string, any>;
}

// @public
export class SeriesDataUnit extends BasicUnit {
    // (undocumented)
    series: Series[];
}

// @public
export class StopLossOrderMapperUnit extends BasicUnit {
    constructor(kernel: Kernel, account_id: string, resumeOnSourceMarginBelow: number, stopLossDrawdownQuota: number, productDataUnit: ProductDataUnit, quoteDataUnit: QuoteDataUnit, sourceAccountSimulatorUnit: AccountSimulatorUnit, sourceAccountPerformanceUnit: AccountPerformanceUnit, sourceHistoryOrderUnit: HistoryOrderUnit, targetAccountSimulatorUnit: AccountSimulatorUnit, targetOrderMatchingUnit: OrderMatchingUnit, targetHistoryOrderUnit: HistoryOrderUnit);
    // (undocumented)
    account_id: string;
    // (undocumented)
    in_stop_loss_state: boolean;
    // (undocumented)
    kernel: Kernel;
    // (undocumented)
    onDispose(): void | Promise<void>;
    // (undocumented)
    onEvent(): void;
    // (undocumented)
    onInit(): void | Promise<void>;
    // (undocumented)
    productDataUnit: ProductDataUnit;
    // (undocumented)
    quoteDataUnit: QuoteDataUnit;
    // (undocumented)
    resumeOnSourceMarginBelow: number;
    // (undocumented)
    sourceAccountPerformanceUnit: AccountPerformanceUnit;
    // (undocumented)
    sourceAccountSimulatorUnit: AccountSimulatorUnit;
    // (undocumented)
    sourceHistoryOrderUnit: HistoryOrderUnit;
    // (undocumented)
    stopLossDrawdownQuota: number;
    // (undocumented)
    targetAccountSimulatorUnit: AccountSimulatorUnit;
    // (undocumented)
    targetHistoryOrderUnit: HistoryOrderUnit;
    // (undocumented)
    targetOrderMatchingUnit: OrderMatchingUnit;
}

// (No @packageDocumentation comment for this package)

```
