## API Report File for "@yuants/protocol"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import { JSONSchema7 } from 'json-schema';
import { Observable } from 'rxjs';
import { Registry } from 'promjs/registry';
import { Subject } from 'rxjs';

// @public
export function createConnectionJson<T = any>(URL: string): IConnection<T>;

// @public
export function createConnectionWs<T = any>(URL: string): IConnection<T>;

// @public
export interface IAccountInfo {
    account_id: string;
    money: IAccountMoney;
    orders: IOrder[];
    positions: IPosition[];
    timestamp_in_us: number;
}

// @alpha @deprecated
export interface IAccountingAsset {
    account_id: string;
    active: number;
    asset_id: string;
    inactive: number;
}

// @public
export interface IAccountMoney {
    balance: number;
    currency: string;
    equity: number;
    free: number;
    leverage?: number;
    profit: number;
    used: number;
}

// @public
export interface IConnection<T> {
    connection$: Observable<unknown>;
    input$: Observable<T>;
    output$: Subject<T>;
}

// @public
export interface IDataRecord<T = unknown> {
    created_at: number | null;
    frozen_at: number | null;
    id: string;
    origin: T;
    tags: Record<string, string>;
    type: string;
    updated_at: number;
}

// @public
export interface IDeploySpec {
    annotations?: Record<string, string>;
    cpu?: IResourceClaim;
    env?: Record<string, string>;
    filesystem?: Record<string, string>;
    memory?: IResourceClaim;
    network?: {
        port_forward?: Record<string, number>;
        backward_proxy?: Record<string, string>;
    };
    one_json?: any;
    package: string;
    version?: string;
}

// @public
export interface IDeployTasks {
    make_docker_compose_file: (ctx: IDeploySpec, envCtx: IEnvContext) => Promise<object>;
    make_json_schema: () => JSONSchema7;
    make_k8s_resource_objects: (ctx: IDeploySpec, envCtx: IEnvContext) => Promise<object>;
}

// @public
export interface IEnvContext {
    createHashOfSHA256: (content: string) => Promise<string>;
    isDirectory: (path: string) => Promise<boolean>;
    readdir: (path: string) => Promise<string[]>;
    readFile: (path: string) => Promise<string>;
    readFileAsBase64: (path: string) => Promise<string>;
    resolveLocal: (path: string) => Promise<string>;
    toBase64String: (str: string) => Promise<string>;
    version: string;
}

// @public
export interface IInfluxPoint {
    // (undocumented)
    fields?: Record<string, string | number>;
    // (undocumented)
    measurement: string;
    // (undocumented)
    tags?: Record<string, string>;
    // (undocumented)
    timestamp?: Date | string | number;
}

// @public
export class InfluxClient {
    constructor(dsn: string);
    // (undocumented)
    dsn: string;
    writePoint(point: IInfluxPoint): void;
}

// @public
export interface IOrder {
    account_id: string;
    client_order_id: string;
    comment?: string;
    direction: OrderDirection;
    exchange_order_id?: string;
    inferred_base_currency_price?: number;
    originator?: string;
    position_id?: string;
    price?: number;
    product_id: string;
    profit_correction?: number;
    real_profit?: number;
    status?: OrderStatus;
    stop_loss_price?: number;
    take_profit_price?: number;
    timestamp_in_us?: number;
    traded_price?: number;
    traded_volume?: number;
    type: OrderType;
    volume: number;
}

// @public
export interface IPeriod {
    close: number;
    datasource_id: string;
    high: number;
    low: number;
    open: number;
    open_interest?: number;
    period_in_sec: number;
    product_id: string;
    spread?: number;
    timestamp_in_us: number;
    volume: number;
}

// @public
export interface IPosition {
    closable_price: number;
    comment?: string;
    floating_profit: number;
    free_volume: number;
    position_id: string;
    position_price: number;
    product_id: string;
    variant: PositionVariant;
    volume: number;
}

// @public
export interface IProduct {
    allow_long?: boolean;
    allow_short?: boolean;
    base_currency: string;
    datasource_id: string;
    is_underlying_base_currency?: boolean;
    margin_rate?: number;
    max_position?: number;
    max_volume?: number;
    name?: string;
    price_step?: number;
    product_id: string;
    quoted_currency?: string;
    spread?: number;
    value_based_cost?: number;
    value_speed?: number;
    volume_based_cost?: number;
    volume_step?: number;
}

// @public
export interface IProductPositionSummary {
    net_volume: number;
    position_price: number;
    product_id: string;
}

// @public
export interface IResourceClaim {
    max?: string;
    min?: string;
}

// @public
export interface IResponse<T = void> {
    // (undocumented)
    code: number;
    // (undocumented)
    data?: T;
    // (undocumented)
    message: string;
}

// @public
export interface IService {
}

// @public @deprecated
export interface IServiceInfo {
    account_id?: string;
    datasource_id?: string;
    name?: string;
    service_id: string;
    ttl_in_sec?: number;
}

// @public
export interface ISubscriptionRelation {
    channel_id: string;
    consumer_terminal_id: string;
    provider_terminal_id: string;
}

// @public
export interface ITerminalInfo {
    discriminator?: JSONSchema7;
    env?: string;
    name: string;
    owner?: string;
    // @deprecated
    ping?: number;
    serviceInfo: Record<string, {
        method: string;
        schema: JSONSchema7;
    }>;
    services?: Array<{
        account_id?: string;
        datasource_id?: string;
        storage?: {};
    }>;
    start_timestamp_in_ms?: number;
    status?: string;
    terminal_id: string;
}

// @public
export interface ITerminalMessage {
    // (undocumented)
    frame?: unknown;
    // (undocumented)
    method: string;
    // (undocumented)
    req?: unknown;
    // (undocumented)
    res?: IResponse<unknown>;
    source_terminal_id: string;
    target_terminal_id: string;
    // (undocumented)
    trace_id: string;
}

// @public
export interface ITick {
    ask?: number;
    bid?: number;
    datasource_id: string;
    open_interest?: number;
    price: number;
    product_id: string;
    spread?: number;
    timestamp_in_us: number;
    volume: number;
}

// @public
export interface ITrade {
    close_price: number;
    close_timestamp_in_us: number;
    cost: number;
    direction: TradeDirection;
    net_profit: number;
    open_price: number;
    open_timestamp_in_us: number;
    product_id: string;
    profit: number;
    volume: number;
}

// @public
export function makeDockerEnvs(env?: Record<string, string>): string[];

// @public
export function makeK8sEnvs(env?: Record<string, string>): {
    name: string;
    value: string;
}[];

// @public
export function mapOrderDirectionToNetPositionCoef(direction: OrderDirection): number;

// @public
export function mapPositionVariantToNetPositionCoef(variant: PositionVariant): number;

// @public
export const mergeAccountInfoPositions: (info: IAccountInfo) => Observable<IAccountInfo>;

// @public (undocumented)
export const mergeSchema: (packageSchema: JSONSchema7) => JSONSchema7;

// @public
export enum OrderDirection {
    CLOSE_LONG = 1,
    CLOSE_SHORT = 3,
    OPEN_LONG = 0,
    OPEN_SHORT = 2
}

// @public
export enum OrderStatus {
    ACCEPTED = 0,
    CANCELLED = 2,
    TRADED = 1
}

// @public
export enum OrderType {
    FOK = 3,
    IOC = 4,
    LIMIT = 1,
    MARKET = 0,
    STOP = 2
}

// @public
export enum PositionVariant {
    LONG = 0,
    SHORT = 1
}

// @public
export const PromRegistry: Registry;

// @public
export class Terminal {
    constructor(HV_URL: string, terminalInfoInput: Omit<ITerminalInfo, 'serviceInfo'>, connection?: IConnection<ITerminalMessage>);
    accountIds$: Observable<string[]>;
    // (undocumented)
    cancelOrder: (order: IOrder) => Observable<(IResponse<void> & IResponse<unknown>) | undefined>;
    // (undocumented)
    _conn: IConnection<ITerminalMessage>;
    // Warning: (ae-forgotten-export) The symbol "ICopyDataRecordsRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    copyDataRecords: (req: ICopyDataRecordsRequest, target_terminal_id?: string) => Observable<undefined>;
    datasourceIds$: Observable<string[]>;
    // (undocumented)
    dispose(): void;
    feed: (channel_id: string, data: any, target_terminal_id: string) => void;
    // (undocumented)
    HV_URL: string;
    // (undocumented)
    modifyOrder: (order: IOrder) => Observable<(IResponse<void> & IResponse<unknown>) | undefined>;
    provideAccountInfo: (accountInfo$: Observable<IAccountInfo>) => void;
    providePeriods: (datasource_id: string, usePeriods: (product_id: string, period_in_sec: number) => Observable<IPeriod[]>) => void;
    provideTicks: (datasource_id: string, useTicks: (product_id: string) => Observable<ITick>) => void;
    // Warning: (ae-forgotten-export) The symbol "IQueryDataRecordsRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    queryDataRecords: <T>(req: IQueryDataRecordsRequest, target_terminal_id?: string) => Observable<IDataRecord<T>>;
    // Warning: (ae-forgotten-export) The symbol "IQueryHistoryOrdersRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    queryHistoryOrders: (req: IQueryHistoryOrdersRequest, target_terminal_id?: string) => Observable<IOrder[]>;
    // Warning: (ae-forgotten-export) The symbol "IQueryPeriodsRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    queryPeriods: (req: IQueryPeriodsRequest, target_terminal_id?: string) => Observable<IPeriod[]>;
    // Warning: (ae-forgotten-export) The symbol "IQueryProductsRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    queryProducts: (req: IQueryProductsRequest, target_terminal_id?: string) => Observable<IProduct[]>;
    // Warning: (ae-forgotten-export) The symbol "IRemoveDataRecordsRequest" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    removeDataRecords: (req: IRemoveDataRecordsRequest, target_terminal_id?: string) => Observable<never>;
    // (undocumented)
    request<T extends string>(method: T, target_terminal_id: string | undefined, req: T extends keyof IService ? IService[T]['req'] : ITerminalMessage['req']): Observable<T extends keyof IService ? Partial<IService[T]> & ITerminalMessage : ITerminalMessage>;
    // Warning: (ae-forgotten-export) The symbol "IServiceHandler" needs to be exported by the entry point index.d.ts
    //
    // (undocumented)
    setupService: <T extends string>(method: T, handler: IServiceHandler<T>, concurrent?: number, rateLimitConfig?: {
        count: number;
        period: number;
    }) => void;
    // (undocumented)
    submitOrder: (order: IOrder) => Observable<(IResponse<void> & IResponse<unknown>) | undefined>;
    subscriptionSnapshot$: Observable<ISubscriptionRelation[]>;
    subscriptionSnapshotOfAccountInfo$: Observable<{
        account_id: string;
        consumer_terminal_ids: string[];
    }[]>;
    subscriptionSnapshotOfPeriod$: Observable<{
        datasource_id: string;
        product_id: string;
        period_in_sec: number;
        consumer_terminal_ids: string[];
    }[]>;
    subscriptionSnapshotOfTick$: Observable<{
        datasource_id: string;
        product_id: string;
        consumer_terminal_ids: string[];
    }[]>;
    // (undocumented)
    terminalInfo: ITerminalInfo;
    // (undocumented)
    terminalInfoInput: Omit<ITerminalInfo, 'serviceInfo'>;
    terminalInfos$: Observable<ITerminalInfo[]>;
    // (undocumented)
    updateDataRecords: (records: IDataRecord<any>[], target_terminal_id?: string) => Observable<never>;
    updateHistoryOrders: (orders: IOrder[], target_terminal_id?: string) => Observable<never[]>;
    updatePeriods: (periods: IPeriod[], target_terminal_id?: string) => Observable<never[]>;
    updateProducts: (products: IProduct[], target_terminal_id?: string) => Observable<never[]>;
    useAccountInfo: (account_id: string) => Observable<IAccountInfo>;
    // (undocumented)
    useFeed: <T>(channel_id: string) => Observable<T>;
    usePeriod: (datasource_id: string, product_id: string, period_in_sec: number) => Observable<IPeriod>;
    useProducts: (datasource_id: string) => Observable<IProduct[]>;
    useTick: (datasource_id: string, product_id: string) => Observable<ITick>;
}

// @public
export enum TradeDirection {
    LONG = 0,
    SHORT = 1
}

```
